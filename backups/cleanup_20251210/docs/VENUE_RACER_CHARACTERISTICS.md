# 競艇場・選手特性分析レポート

**分析期間**: 2024-04-01 〜 2024-06-30
**生成日時**: 2025-11-13 21:36:55
**データソース**: boatrace.db (14,724レース、24会場)

---

## 📊 エグゼクティブサマリー

### 主要な発見

1. **1号艇の圧倒的優位性**
   - 全会場平均で1号艇の勝率は **60.3%**
   - 2〜3連率は **77.8%** と極めて高い
   - 最高: 会場24（桐生）で **75.9%**、最低: 会場04（平和島）で **41.7%**

2. **級別による明確な差**
   - A1級: 勝率 **25.5%**、平均着順 **2.98**
   - B2級: 勝率 **5.3%**、平均着順 **4.75**
   - A1とB2で **20.3ポイント** の勝率差

3. **会場特性の多様性**
   - 1号艇勝率のレンジ: 41.7%（会場04）〜 75.9%（会場24）
   - **34.2ポイント** の差 → 会場特性が極めて重要

4. **枠番と着順の強い相関**
   - 1号艇: 60.3% / 2号艇: 13.2% / 3号艇: 11.1%
   - 内側の枠ほど有利（競艇の基本原則を再確認）

---

## 1. 会場別特性分析

### 1.1 全会場データ（24会場）

| 会場コード | レース数 | 1号艇勝率 | 2号艇勝率 | 3号艇勝率 | 平均モーター2連対率 |
|:--------:|:-------:|:--------:|:--------:|:--------:|:----------------:|
| 24 | 108 | **75.9%** | 11.1% | 5.6% | 32.8% |
| 09 | 120 | 72.5% | 6.7% | 7.5% | 31.1% |
| 12 | 120 | 68.3% | 8.3% | 10.8% | 32.9% |
| 11 | 84 | 66.7% | 4.8% | 7.1% | 32.1% |
| 17 | 108 | 65.7% | 10.2% | 8.3% | 34.5% |
| 18 | 36 | 66.7% | 16.7% | 11.1% | 30.6% |
| 06 | 108 | 62.0% | 11.1% | 13.0% | 30.0% |
| 07 | 108 | 62.0% | 10.2% | 9.3% | 33.8% |
| 13 | 84 | 61.9% | 8.3% | 14.3% | 33.9% |
| 08 | 144 | 61.1% | 13.2% | 11.8% | 29.7% |
| 10 | 108 | 61.1% | 15.7% | 13.0% | 31.2% |
| 21 | 108 | 61.1% | 12.0% | 9.3% | 32.5% |
| 16 | 120 | 61.7% | 10.0% | 11.7% | 33.7% |
| 05 | 120 | 60.0% | 14.2% | 9.2% | 33.4% |
| 15 | 72 | 59.7% | 9.7% | 6.9% | 30.9% |
| 22 | 108 | 59.3% | 19.4% | 13.0% | 31.2% |
| 19 | 120 | 56.7% | 16.7% | 10.0% | 30.2% |
| 01 | 108 | 55.6% | 8.3% | 13.9% | 31.6% |
| 20 | 96 | 55.2% | 19.8% | 9.4% | 31.5% |
| 23 | 108 | 51.9% | 17.6% | 10.2% | 32.3% |
| 03 | 84 | 50.0% | 15.5% | 13.1% | 29.4% |
| 14 | 120 | 49.2% | 16.7% | 13.3% | 30.9% |
| 02 | 108 | 46.3% | 15.7% | 17.6% | 34.3% |
| 04 | 84 | **41.7%** | 22.6% | 13.1% | 33.2% |

### 1.2 会場特性の分類

#### 🔥 超インコース有利（1号艇勝率70%以上）
- **会場24（桐生）**: 75.9%
- **会場09（津）**: 72.5%

→ 1号艇に乗る選手を重視すべき会場

#### ⚖️ インコース有利（1号艇勝率60〜70%）
- 会場12, 11, 17, 18, 06, 07, 13, 08, 10, 21, 16（11会場）

→ 標準的な競艇場特性

#### 🌊 アウトコースチャンスあり（1号艇勝率50〜60%）
- 会場05, 15, 22, 19, 01, 20, 23, 03（8会場）

→ 2号艇以降の選手にもチャンスがある

#### ⚠️ インコース不利（1号艇勝率50%未満）
- **会場14（鳴門）**: 49.2%
- **会場02（戸田）**: 46.3%
- **会場04（平和島）**: 41.7%

→ 2号艇・3号艇の選手も重視すべき会場

---

## 2. 級別パフォーマンス分析

### 2.1 級別統計（全会場合計）

| 級別 | 出走数 | 勝率 | 平均着順 | 平均選手勝率 |
|:---:|:-----:|:----:|:-------:|:-----------:|
| A1 | 3,104 | **25.5%** | 2.98 | 6.62% |
| A2 | 3,413 | 23.5% | 3.07 | 5.77% |
| B1 | 7,141 | 11.7% | 3.69 | 4.59% |
| B2 | 1,066 | 5.3% | 4.75 | 2.44% |

### 2.2 級別の重要性

- **A1 vs A2**: 勝率差 2.0ポイント → 比較的小さい
- **A2 vs B1**: 勝率差 11.8ポイント → 大きな差
- **B1 vs B2**: 勝率差 6.4ポイント → 中程度の差

**結論**: A級とB級の境界が最も重要。A1/A2の差は小さい。

---

## 3. 枠番別パフォーマンス

### 3.1 全会場平均（14,724レース）

| 枠番 | 出走数 | 勝率 | 2連対率 | 枠番有利度 |
|:---:|:-----:|:----:|:------:|:--------:|
| 1号艇 | 2,459 | **60.3%** | **77.8%** | 🔥🔥🔥🔥🔥 |
| 2号艇 | 2,451 | 13.2% | 40.7% | 🔥🔥 |
| 3号艇 | 2,459 | 11.1% | 34.3% | 🔥 |
| 4号艇 | 2,448 | 9.1% | 24.8% | ⚖️ |
| 5号艇 | 2,450 | 5.4% | 16.5% | ⚠️ |
| 6号艇 | 2,457 | 2.0% | 8.3% | ❌ |

### 3.2 枠番の影響力

- 1号艇は2号艇の **4.6倍** の勝率
- 1号艇は6号艇の **30倍** の勝率
- 3号艇以降は勝率が急激に低下

**結論**: 枠番（特に1号艇）は最も重要な予測因子の1つ

---

## 4. 会場×級別クロス分析

### 4.1 会場別のA1級勝率（上位10会場）

| 会場 | A1勝率 | A2勝率 | B1勝率 | 特徴 |
|:---:|:-----:|:-----:|:-----:|:-----|
| 11 | 34.4% | 21.7% | 10.8% | A1級が特に強い |
| 09 | 32.0% | 29.6% | 8.5% | A級全体が強い |
| 08 | 30.2% | 26.3% | 11.1% | バランス型 |
| 21 | 30.8% | 25.0% | 8.9% | A級優位 |
| 01 | 29.9% | 19.6% | 11.6% | A1とA2の差が大きい |
| 15 | 29.5% | 18.9% | 13.9% | B1もチャンスあり |
| 20 | 29.5% | 20.1% | 12.4% | 中程度のバランス |
| 13 | 28.3% | 14.8% | 11.6% | A1突出型 |
| 19 | 28.2% | 23.2% | 11.8% | A級全体優位 |
| 10 | 28.8% | 25.8% | 11.1% | A級バランス型 |

### 4.2 インサイト

1. **会場11（びわこ）**: A1級が34.4%と最高 → A1級選手を特に重視
2. **会場09（津）**: A級全体（A1+A2）が60%超 → A級なら誰でも有利
3. **会場02（戸田）**: A1が21.9%と低い → 級別より他要素が重要

---

## 5. トップ選手分析

### 5.1 データ不足

- **50レース以上出走した選手が0名**

**原因**: 分析期間が3ヶ月（2024-04-01〜06-30）と短いため

**対応策**:
1. 分析期間を1年以上に延長
2. 30レース以上に基準を下げる
3. 別途、長期データで選手ランキングを作成

---

## 6. 特徴量エンジニアリングへの応用

### 6.1 会場特性の特徴量化

#### 推奨特徴量（優先度順）

1. **venue_pit1_win_rate**（会場別1号艇勝率）
   - 41.7%〜75.9%の幅 → 予測に大きく影響
   - 実装: `venue_code`をキーに勝率をマッピング

2. **venue_inner_bias**（会場のインコース有利度）
   - `(pit1_win_rate - pit2_win_rate) / pit1_win_rate`
   - インコース特化型 vs バランス型を数値化

3. **venue_motor_quality**（会場平均モーター2連対率）
   - 29.4%〜34.5%の幅
   - モーター整備の質を反映

4. **venue_category**（会場カテゴリ）
   - "super_inner" (70%+), "inner" (60-70%), "balanced" (50-60%), "outer" (<50%)
   - カテゴリカル変数としてダミー変数化

#### 実装例（Pythonコード）

```python
# 会場特性マッピング辞書
VENUE_PIT1_WIN_RATE = {
    '01': 55.6, '02': 46.3, '03': 50.0, '04': 41.7, '05': 60.0,
    '06': 62.0, '07': 62.0, '08': 61.1, '09': 72.5, '10': 61.1,
    '11': 66.7, '12': 68.3, '13': 61.9, '14': 49.2, '15': 59.7,
    '16': 61.7, '17': 65.7, '18': 66.7, '19': 56.7, '20': 55.2,
    '21': 61.1, '22': 59.3, '23': 51.9, '24': 75.9
}

# 特徴量追加
df['venue_pit1_win_rate'] = df['venue_code'].map(VENUE_PIT1_WIN_RATE)
df['venue_inner_bias'] = df['venue_pit1_win_rate'] / (df['venue_pit1_win_rate'] + df['venue_pit2_win_rate'])

# 会場カテゴリ
def categorize_venue(rate):
    if rate >= 70: return 'super_inner'
    elif rate >= 60: return 'inner'
    elif rate >= 50: return 'balanced'
    else: return 'outer'

df['venue_category'] = df['venue_pit1_win_rate'].apply(categorize_venue)
df = pd.get_dummies(df, columns=['venue_category'])
```

### 6.2 級別の特徴量化

#### 推奨特徴量

1. **grade_win_rate**（級別平均勝率）
   - A1: 25.5%, A2: 23.5%, B1: 11.7%, B2: 5.3%
   - 単純なマッピングで強力な特徴量に

2. **grade_rank**（級別順位）
   - A1=1, A2=2, B1=3, B2=4
   - 順序情報を保持

3. **is_a_class**（A級フラグ）
   - A1/A2 = 1, B1/B2 = 0
   - A級とB級の境界を強調

4. **grade_dummy**（級別ダミー変数）
   - grade_A1, grade_A2, grade_B1, grade_B2
   - One-hot encoding

#### 実装例

```python
# 級別勝率マッピング
GRADE_WIN_RATE = {'A1': 25.5, 'A2': 23.5, 'B1': 11.7, 'B2': 5.3}
df['grade_win_rate'] = df['racer_rank'].map(GRADE_WIN_RATE)

# 級別順位
GRADE_RANK = {'A1': 1, 'A2': 2, 'B1': 3, 'B2': 4}
df['grade_rank'] = df['racer_rank'].map(GRADE_RANK)

# A級フラグ
df['is_a_class'] = df['racer_rank'].isin(['A1', 'A2']).astype(int)

# ダミー変数
df = pd.get_dummies(df, columns=['racer_rank'], prefix='grade')
```

### 6.3 交互作用項の追加

#### 推奨交互作用項

1. **pit_number × venue_pit1_win_rate**
   - 1号艇 × インコース有利度 → 最強の組み合わせ

2. **grade_win_rate × venue_pit1_win_rate**
   - A1級 × インコース会場 → 勝率極大化

3. **pit_number_1 × grade_A1**
   - 1号艇 × A1級 → ダブルアドバンテージ

4. **pit_number × is_a_class**
   - 枠番 × A級フラグ → 簡易版の相乗効果

#### 実装例

```python
# 交互作用項
df['pit1_venue_inner'] = df['pit_number_1'] * df['venue_pit1_win_rate']
df['grade_venue_inner'] = df['grade_win_rate'] * df['venue_pit1_win_rate']
df['pit1_gradeA1'] = df['pit_number_1'] * df['grade_A1']
df['pit_aclass'] = df['pit_number'] * df['is_a_class']
```

---

## 7. モデル学習への推奨事項

### 7.1 Phase 1: 会場・級別特徴量追加（推奨：即実施）

**追加特徴量**:
- venue_pit1_win_rate
- venue_category (ダミー変数)
- grade_win_rate
- is_a_class
- pit1_venue_inner（交互作用）

**期待効果**:
- AUC: 0.8551 → **0.87〜0.88** （推定 +1.5〜2.5%）
- 的中率（0.8+確率帯）: 77.9% → **80〜82%** （推定 +2〜4%）

**実装時間**: 1〜2時間

### 7.2 Phase 2: 会場×級別クロス特徴量（推奨：Phase 1後）

**追加特徴量**:
- venue_grade_win_rate（会場×級別の勝率マッピング）
- venue_motor_quality × grade_rank
- venue_inner_bias × pit_number

**期待効果**:
- AUC: 0.87 → **0.88〜0.89** （推定 +1〜2%）

**実装時間**: 2〜3時間

### 7.3 Phase 3: 長期データで再分析（推奨：データ蓄積後）

**必要データ**:
- 1年以上の履歴（選手個別分析に必要）
- 天候データ（weather テーブル活用）
- オッズデータ（payouts テーブル活用）

**期待効果**:
- 選手個別の傾向把握
- 天候影響の定量化
- 期待値ベース投資戦略

---

## 8. 実験計画

### 実験#004: 会場・級別特徴量追加版

**目的**: 会場特性と級別情報を特徴量化してベースラインモデルを改善

**追加特徴量**:
1. venue_pit1_win_rate (連続値)
2. venue_category_super_inner, _inner, _balanced, _outer (ダミー)
3. grade_win_rate (連続値)
4. is_a_class (バイナリ)
5. pit1_venue_inner (交互作用)

**学習スクリプト**: `train_stage2_with_venue_grade.py`

**評価基準**:
- ベースライン（実験#001）との比較
- AUC, Log Loss, 的中率（0.8+確率帯）
- 特徴量重要度での venue/grade 系の順位

**成功条件**:
- AUC +1.5%以上（0.8551 → 0.8705+）
- 的中率 +2%以上（77.9% → 80.0%+）

---

## 9. データ品質に関する注意事項

### 9.1 分析期間の制約

- **期間**: 2024-04-01 〜 2024-06-30（3ヶ月間）
- **レース数**: 14,724レース（24会場）
- **選手分析**: 50レース以上出走の選手が0名

**推奨**: 1年以上のデータで再分析

### 9.2 会場18のデータ不足

- レース数: **36レース** （他会場の1/3以下）
- 勝率データの信頼性が低い

**対応**: モデル学習時に venue_code=18 を除外、または重み付け

### 9.3 欠損データ

- トップ選手データ（Empty DataFrame）
- 天候データ（未使用）

**今後の対応**:
1. weather テーブルとの結合
2. 長期データでの選手ランキング作成

---

## 10. まとめ

### 主要な知見

1. **1号艇の勝率は会場によって2倍近く変動**（42%〜76%）
   → 会場特性の特徴量化が必須

2. **A級とB級の勝率差は約15ポイント**
   → 級別情報は強力な予測因子

3. **枠番は最も強力な予測因子**
   → 1号艇は2号艇の4.6倍の勝率

4. **会場×級別の交互作用が存在**
   → 会場11ではA1が34.4%、会場02では21.9%

### 次のアクションアイテム

**即実施推奨**:
- [ ] venue_pit1_win_rate の追加
- [ ] grade_win_rate の追加
- [ ] pit1_venue_inner（交互作用）の追加
- [ ] 実験#004の実行とベースライン比較

**短期（1〜2週間）**:
- [ ] 会場カテゴリダミー変数の追加
- [ ] 会場×級別クロス特徴量の追加
- [ ] SHAP値分析で特徴量寄与を可視化

**中長期（1〜3ヶ月）**:
- [ ] 1年分のデータで再分析
- [ ] 天候データの特徴量化
- [ ] 選手個別の傾向分析（30レース以上）

---

**生成日時**: 2025-11-13 21:36:55
**次回更新予定**: Phase 1 完了時（実験#004結果反映）
