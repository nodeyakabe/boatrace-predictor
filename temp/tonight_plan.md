# 今夜のデータ収集計画

## 📊 現在の状況（2025-12-03 17:00時点）

### 2025年データ収集状況
- **総レース数**: 16,679件
- **レース詳細**: 82.2%完了（残り2,972件） ← 現在実行中
- **決まり手**: ✅ 100%完了
- **払戻金**: 219件不足（98.7%完了）
- **直前情報**: 1,057件不足（93.7%完了）

### 実行中タスク
```
補完_レース詳細データ_軽量版.py --start-date 2025-01-01 --end-date 2025-12-31
```
- 進捗: 82.2%
- 残り: 約2,972件
- 推定残り時間: 約20-30分

## 🌙 夜間自動収集の設定

### 方法1: 自動収集スクリプトを使う（推奨）

**今すぐ実行するコマンド:**
```bash
cd c:\Users\User\Desktop\BR\BoatRace_package_20251115_172032
python scripts/night_auto_collection.py
```

このスクリプトは以下を自動で実行します:
1. レース詳細の残りを収集（まだ未完了の場合）
2. 払戻金と直前情報を収集
3. 各タスクの完了を待ってから次へ進む
4. 最終的な収集状況を報告

**特徴:**
- ✅ 各タスクの完了を待ってから次へ進む
- ✅ 進捗状況をリアルタイムで表示
- ✅ エラーハンドリング付き
- ✅ 最終レポート自動生成

### 方法2: 個別にコマンド実行

現在のレース詳細補完が完了した後、手動で以下を実行:

```bash
# 1. レース詳細の残りを収集（必要に応じて）
python 補完_レース詳細データ_軽量版.py --start-date 2025-01-01 --end-date 2025-12-31

# 2. 払戻金と直前情報を収集
python scripts/bulk_missing_data_fetch_12h.py --start-date 2025-01-01 --end-date 2025-12-31
```

## ⏱️ 推定完了時間

| タスク | 対象件数 | 推定時間 | 完了予定時刻 |
|--------|----------|----------|--------------|
| レース詳細（残り） | 2,972件 | 20-30分 | 17:30頃 |
| 払戻金・直前情報 | 1,276件 | 10-15分 | 17:45頃 |
| **合計** | - | **30-45分** | **17:45頃** |

## 🎯 完了後の状態

すべて完了すると、2025年データは以下のようになります:
- ✅ レース詳細: 100%
- ✅ 決まり手: 100%
- ✅ 払戻金: 100%
- ✅ 直前情報: 100%

## 📝 実行手順

### 推奨手順
1. **現在のタスクを確認**
   ```bash
   # プロセスを確認（実行中か確認）
   # WindowsならタスクマネージャーでPythonプロセスを確認
   ```

2. **夜間自動収集を開始**
   ```bash
   cd c:\Users\User\Desktop\BR\BoatRace_package_20251115_172032
   python scripts/night_auto_collection.py
   ```

3. **放置してOK**
   - スクリプトが自動的にすべてのタスクを完了させます
   - 完了したら最終レポートが表示されます

## 🔍 進捗確認方法

実行中にいつでも進捗を確認できます:

```bash
cd c:\Users\User\Desktop\BR\BoatRace_package_20251115_172032
python temp/night_collection_plan.py
```

## ⚠️ 注意事項

1. **現在実行中のスクリプトについて**
   - 補完_レース詳細データ_軽量版.py が実行中の場合、完了を待ってから night_auto_collection.py を実行
   - または、night_auto_collection.py が自動的に残りを処理

2. **PCの電源**
   - スクリプト実行中はPCをスリープさせない
   - 推定45分程度で完了予定

3. **エラーが発生した場合**
   - スクリプトはエラーをレポートして次のタスクへ進みます
   - 最終レポートで失敗したタスクを確認できます

## 📊 明日の朝の確認

明日の朝、以下のコマンドで結果を確認:

```bash
cd c:\Users\User\Desktop\BR\BoatRace_package_20251115_172032
python temp/night_collection_plan.py
```

すべて完了していれば「✅ 2025年のデータ収集は完了しています！」と表示されます。
