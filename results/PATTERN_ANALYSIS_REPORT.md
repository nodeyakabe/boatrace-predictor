# BEFOREパターン分析レポート

分析日: 2025-12-10
対象期間: 2025年データ
分析レース数: 1000レース（長期）+ 100レース（短期）

---

## エグゼクティブサマリー

BEFOREパターンシステムの効果検証を実施。1000レースの分析により、**信頼度B/Cレースで明確な効果**を確認。一方、信頼度Aレースでは逆効果となる興味深い結果が得られた。

### 主要な発見

1. **全体効果**: パターンあり 54.0% vs なし 50.5% (+3.5ポイント)
2. **信頼度B**: +9.5ポイントの大幅改善（最も効果的）
3. **信頼度C**: +8.3ポイントの改善
4. **信頼度A**: -6.5ポイント（逆効果、要注意）

---

## 1. 全体統計（1000レース分析）

### パターン適用状況

| 項目 | レース数 | 的中数 | 的中率 |
|------|---------|--------|--------|
| **パターンあり** | 513 | 277 | **54.0%** |
| **パターンなし** | 487 | 246 | **50.5%** |
| **全体** | 1000 | 523 | **52.3%** |

**結論**: パターン適用により+3.5ポイントの改善

---

## 2. 信頼度別詳細分析

### 信頼度A（最高信頼度）

| パターン | レース数 | 的中数 | 的中率 |
|---------|---------|--------|--------|
| あり | 22 | 16 | **72.7%** |
| なし | 53 | 42 | **79.2%** |
| **効果** | - | - | **-6.5pt** ⚠️ |

**考察**:
- 信頼度Aレースは元々高精度（79%）
- パターン適用により逆に精度が下がる
- 推奨: **信頼度Aレースではパターンを適用しない**

### 信頼度B（高信頼度）

| パターン | レース数 | 的中数 | 的中率 |
|---------|---------|--------|--------|
| あり | 199 | 130 | **65.3%** |
| なし | 222 | 124 | **55.9%** |
| **効果** | - | - | **+9.5pt** ✅ |

**考察**:
- **最も効果的な信頼度レベル**
- 約10ポイントの大幅改善
- 推奨: **信頼度Bレースで積極的にパターン活用**

### 信頼度C（中信頼度）

| パターン | レース数 | 的中数 | 的中率 |
|---------|---------|--------|--------|
| あり | 256 | 122 | **47.7%** |
| なし | 193 | 76 | **39.4%** |
| **効果** | - | - | **+8.3pt** ✅ |

**考察**:
- 信頼度Bに次ぐ効果
- ボリュームゾーンで安定した改善
- 推奨: **信頼度Cレースでもパターン活用推奨**

### 信頼度D（低信頼度）

| パターン | レース数 | 的中数 | 的中率 |
|---------|---------|--------|--------|
| あり | 36 | 9 | **25.0%** |
| なし | 19 | 4 | **21.1%** |
| **効果** | - | - | **+3.9pt** |

**考察**:
- サンプル数が少ない
- 効果は限定的だが一応プラス
- 推奨: **信頼度Dではパターン適用を慎重に**

---

## 3. 短期分析（100レース、2025-12-04）

### パターン別適用回数と的中率

| パターン名 | 適用回数 | 的中数 | 的中率 |
|-----------|---------|--------|--------|
| **pre1_ex1** | 24 | 15 | **62.5%** ⭐ |
| pre1_ex1_3_st1_3 | 53 | 26 | 49.1% |
| ex1_3_st1_3 | 54 | 26 | 48.1% |
| pre1_4_ex1_2 | 52 | 25 | 48.1% |
| pre1_3_st1_3 | 76 | 36 | 47.4% |
| pre1_st1_3 | 74 | 35 | 47.3% |
| pre1_3_ex1_3 | 73 | 34 | 46.6% |
| ex_rank_1_2 | 52 | 25 | 48.1% |
| pre1_st1 | 35 | 16 | 45.7% |

**最優秀パターン**: `pre1_ex1`（予測1位 × 展示1位）
- 24回適用で62.5%の的中率
- 信頼性の高いパターンとして活用価値が高い

---

## 4. 実装推奨事項

### 4.1 信頼度別パターン適用戦略

```python
if confidence_level == 'A':
    # 信頼度Aではパターンを適用しない
    apply_pattern = False

elif confidence_level in ['B', 'C']:
    # 信頼度B/Cで積極的にパターン適用
    apply_pattern = True
    use_priority_optimizer = True  # 複数パターン時は優先度最適化

elif confidence_level == 'D':
    # 信頼度Dでは限定的に適用
    apply_pattern = True
    conservative_mode = True  # 保守的に適用

else:  # E
    # 信頼度Eでは適用しない
    apply_pattern = False
```

### 4.2 パターン優先度最適化

複数パターンマッチ時の優先順位:
1. `pre1_ex1`（最高的中率62.5%）
2. `pre1_ex1_3_st1_3`（3要素複合、49.1%）
3. `ex1_3_st1_3`（展示×ST、48.1%）
4. その他パターン

### 4.3 ネガティブパターン（警告フラグ）

以下の条件で予測信頼度を下げる：
- 展示・ST両方がワースト2以内
- 展示とSTの順位乖離が4ランク以上
- STタイミングが±0.15秒以上ずれている

---

## 5. ROI改善シミュレーション

### 前提条件
- 平均オッズ: 3.5倍
- ベット単位: 100円
- 対象: 信頼度B/Cレースのみ

### Before（パターンなし）

```
総ベット数: 415レース (B:222 + C:193)
的中数: 200レース (B:124 + C:76)
的中率: 48.2%

投資額: 41,500円
払戻額: 200 × 350円 = 70,000円
収支: +28,500円
回収率: 168.7%
```

### After（パターンあり）

```
総ベット数: 455レース (B:199 + C:256)
的中数: 252レース (B:130 + C:122)
的中率: 55.4%

投資額: 45,500円
払戻額: 252 × 350円 = 88,200円
収支: +42,700円
回収率: 193.8%
```

### 改善効果

- **的中率**: 48.2% → 55.4% (+7.2pt)
- **回収率**: 168.7% → 193.8% (+25.1pt)
- **利益**: +28,500円 → +42,700円 (+14,200円、+49.8%)

---

## 6. 次のステップ

### 優先度: 高

1. **信頼度A除外ロジックの実装**
   - Pattern Priority Optimizerに信頼度チェック追加
   - 信頼度Aでは強制的にパターン無効化

2. **pre1_ex1パターンの優遇**
   - 最高的中率62.5%のため、最優先適用

3. **ネガティブパターンの実装**
   - 警告フラグシステムの追加
   - 該当時は信頼度を1段階下げる

### 優先度: 中

4. **会場別パターン効果の分析**
   - スクリプトのバグ修正後に実施
   - 会場特性との相関を確認

5. **パターン組み合わせボーナスの検証**
   - 相乗効果のある組み合わせを特定

### 優先度: 低

6. **長期バックテスト（全期間）**
   - 2024年以前のデータでも検証
   - 季節性の確認

---

## 7. 結論

BEFOREパターンシステムは**信頼度B/Cレースで明確な効果**を示した。特に：

✅ **採用すべき点**:
- 信頼度B/Cでの積極的なパターン適用
- pre1_ex1パターンの最優先活用
- パターン優先度最適化システムの導入

⚠️ **注意すべき点**:
- 信頼度Aレースではパターンを適用しない
- 信頼度Dレースでは慎重に適用

📊 **期待効果**:
- 的中率: +7.2ポイント改善
- 回収率: +25.1ポイント改善
- 利益: 約50%増加

次フェーズでは、ネガティブパターンの実装と会場別最適化を進める。
